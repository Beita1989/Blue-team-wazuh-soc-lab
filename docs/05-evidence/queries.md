# Wazuh / Sysmon Validation Queries (sanitized)

These queries are used to validate that Sysmon telemetry is correctly ingested by Wazuh and that detections are reproducible.

## EID 1 — Process Create (PowerShell suspicious)
**Goal:** Confirm PowerShell execution with suspicious flags.

**Search terms (KQL-like / UI filters):**
- `event.module:sysmon AND win.system.eventID:1`
- `powershell.exe`
- `EncodedCommand OR -enc`

**Expected fields:**
- `win.eventdata.Image` contains `powershell.exe`
- `win.eventdata.CommandLine` includes `-enc` or `EncodedCommand`

---

## EID 3 — Network Connect (PowerShell outbound)
**Goal:** Confirm outbound network connection generated by the suspicious process.

**Search terms:**
- `event.module:sysmon AND win.system.eventID:3`
- `powershell.exe`
- Destination IP/port (lab-sanitized)

**Expected fields:**
- `win.eventdata.Image` contains `powershell.exe`
- `win.eventdata.DestinationIp` / `DestinationHostname`
- `win.eventdata.DestinationPort`

---

## EID 11 — File Create (dropped payload)
**Goal:** Confirm file creation in a temp/download location.

**Search terms:**
- `event.module:sysmon AND win.system.eventID:11`
- `TargetFilename:*\\Temp\\* OR TargetFilename:*\\Downloads\\*`
- `payload.bin OR .ps1 OR .exe` (depending on the scenario)

**Expected fields:**
- `win.eventdata.TargetFilename` points to a created file
- `win.eventdata.Image` shows the creating process (e.g., `powershell.exe`)
