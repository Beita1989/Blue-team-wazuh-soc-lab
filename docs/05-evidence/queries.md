# Wazuh / Sysmon Validation Queries (sanitized)
> Note: Field names may vary depending on the ingestion pipeline (Wazuh agent / Winlogbeat / Elastic mappings).
> In this repo we use `win.eventdata.*` as a normalized reference. If your deployment uses `winlog.event_data.*`,
> adapt the field path accordingly (same semantics).

These queries are used to validate that Sysmon telemetry is correctly ingested by Wazuh and that detections are reproducible.

## EID 1 — Process Create (PowerShell suspicious)
**Goal:** Confirm PowerShell execution with suspicious flags.

**Search terms (KQL-like / UI filters):**
Copy/paste (KQL-like):
event.module:sysmon AND win.system.eventID:1 AND win.eventdata.Image:*powershell.exe* AND (win.eventdata.CommandLine:* -enc * OR win.eventdata.CommandLine:*EncodedCommand*)

- `event.module:sysmon AND win.system.eventID:1`
- `powershell.exe`
- `EncodedCommand OR -enc`

**Expected fields:**
- `win.eventdata.Image` contains `powershell.exe`
- `win.eventdata.CommandLine` includes `-enc` or `EncodedCommand`

---

## EID 3 — Network Connect (PowerShell outbound)
**Goal:** Confirm outbound network connection generated by the suspicious process.

**Search terms:**
Copy/paste (KQL-like):
event.module:sysmon AND win.system.eventID:3 AND win.eventdata.Image:*powershell.exe*

- `event.module:sysmon AND win.system.eventID:3`
- `powershell.exe`
- Destination IP/port (lab-sanitized)

**Expected fields:**
- `win.eventdata.Image` contains `powershell.exe`
- `win.eventdata.DestinationIp` / `DestinationHostname`
- `win.eventdata.DestinationPort`

---

## EID 11 — File Create (dropped payload)
**Goal:** Confirm file creation in a temp/download location.

**Search terms:**
Copy/paste (KQL-like):
event.module:sysmon AND win.system.eventID:11 AND (win.eventdata.TargetFilename:*\\Temp\\* OR win.eventdata.TargetFilename:*\\Downloads\\*) AND (win.eventdata.TargetFilename:*.ps1 OR win.eventdata.TargetFilename:*.exe OR win.eventdata.TargetFilename:*.bin)

- `event.module:sysmon AND win.system.eventID:11`
- `TargetFilename:*\\Temp\\* OR TargetFilename:*\\Downloads\\*`
- `payload.bin OR .ps1 OR .exe` (depending on the scenario)

**Expected fields:**
- `win.eventdata.TargetFilename` points to a created file
- `win.eventdata.Image` shows the creating process (e.g., `powershell.exe`)
