# Detections (Portfolio)

This document lists the detections validated in this lab. Each detection is mapped to MITRE ATT&CK and has a reproducible evidence trail (queries + sanitized log samples + runbook).

---

## D-001 — Suspicious PowerShell (EncodedCommand / download cradle)

**Goal:** Detect suspicious PowerShell execution patterns commonly used for initial access / execution and payload retrieval.

**Signals**
- Sysmon **EID 1** (Process Create): `powershell.exe` with `-enc` / `EncodedCommand`
- Sysmon **EID 3** (Network Connect): outbound connection generated by the suspicious PowerShell process
- Sysmon **EID 11** (File Create): dropped payload/script in temp/download-like locations (scenario dependent)

**MITRE ATT&CK**
- T1059.001 — Command and Scripting Interpreter: PowerShell  
- T1105 — Ingress Tool Transfer (when download cradle is used)

**Validation / Evidence**
- Runbook: `/docs/incident-runbooks/IR-001-suspicious-powershell.md`
- Queries: `/docs/05-evidence/queries.md`
- Log samples:  
  - `/docs/05-evidence/log-samples/sysmon-eid1-process-create.sample.json`  
  - `/docs/05-evidence/log-samples/sysmon-eid3-network-connect.sample.json`  
  - `/docs/05-evidence/log-samples/sysmon-eid11-file-create.sample.json`
- Screenshot (illustrative): `/docs/capturas/evidence-wazuh.png`

**Notes**
- This is a portfolio lab. Replace “lab-sanitized” IPs/hosts with your environment values.
- Field names can vary by pipeline; adapt queries accordingly.

